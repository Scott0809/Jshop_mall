{"version":3,"sources":["webpack:///src/pages/GoodsList.vue","webpack:///./src/pages/GoodsList.vue?d3a6","webpack:///./src/pages/GoodsList.vue"],"names":["GoodsList","title","checked","top","bottom","condition","_this","this","goodsList","_this2","index","str","filter","_this3","list","_list","page","_this4","catId","hot","keywords","brand","pageSize","where","data","next","pages_GoodsList","render","_vm","_h","$createElement","_c","_self","staticClass","_l","item","key","class","active","on","click","$event","clickFilter","_v","_s","attrs","src","icons","topChecked","_e","bottomChecked","ref","callback","loadMore","distance","scroll-top","slot","theme","type","href","path","query","goods_id","id","image_url","name","price","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"oJA+BAA,+BAIA,sBAEAC,MAAA,KAAAC,SAAA,EAAAC,KAAA,EAAAC,QAAA,EAAAC,UACA,KAAAJ,MAAA,KAAAC,SAAA,EAAAC,KAAA,EAAAC,QAAA,EAAAC,UACA,cAAAJ,MAAA,KAAAC,SAAA,EAAAC,KAAA,EAAAC,QAAA,EAAAC,UAEA,qBAEA,wCACA,mCACA,8CAEA,6RAUA,IAAAC,EAAAC,yCACA,8CAEA,uFAIA,+BACA,sCACA,eAEA,SACA,YACA,iCAKA,OAEAC,8CAIA,IAAAC,EAAAF,qEAGAJ,wCACAC,gEAKAM,aACA,eAIA,YAEA,eAGA,SACA,YACA,WAKA,wDACA,6CACAC,uCACAC,yBAEAJ,kCAGA,IAAAK,EAAAN,oEAEAO,0BACAC,0DAGA,oCAEAC,8BAIA,IAAAC,EAAAV,oEAEAO,sCACAC,0DAGA,mEAGA,oCACAC,mEAOAE,4BAEAC,uCAEAC,wCAEAC,yBAGAL,gBACAM,mBAEAC,sCACAX,QACAY,wFAMA,UAEAC,MCnKAC,GADiBC,OAFjB,WAA0B,IAAAC,EAAArB,KAAasB,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,cAAwBL,EAAAd,KAAA,OAAAiB,EAAA,OAA8BE,YAAA,YAAsBF,EAAA,KAAAH,EAAAM,GAAAN,EAAA,eAAAO,EAAAzB,GAAkD,OAAAqB,EAAA,MAAgBK,IAAA1B,IAAUqB,EAAA,QAAaM,OAAOC,OAAAH,EAAAjC,SAAqBqC,IAAKC,MAAA,SAAAC,GAAyBb,EAAAc,YAAAhC,OAAyBkB,EAAAe,GAAAf,EAAAgB,GAAAT,EAAAlC,UAAA2B,EAAAe,GAAA,KAAAZ,EAAA,OAAqDE,YAAA,aAAuB,EAAAF,EAAA,OAAoBE,YAAA,MAAAY,OAAyBC,IAAAX,EAAAhC,IAAAyB,EAAAmB,MAAAC,WAAApB,EAAAmB,MAAA5C,OAAuDyB,EAAAqB,KAAArB,EAAAe,GAAA,KAAAZ,EAAA,OAAiCE,YAAA,SAAAY,OAA4BC,IAAAX,EAAA/B,OAAAwB,EAAAmB,MAAAG,cAAAtB,EAAAmB,MAAA3C,mBAAsEwB,EAAAqB,KAAArB,EAAAe,GAAA,KAAAZ,EAAA,qBAAkDoB,IAAA,qBAAAlB,YAAA,gBAAAY,OAA4DO,SAAAxB,EAAAyB,SAAAC,SAAA,EAAAC,cAAA,KAAyDxB,EAAA,WAAgBc,OAAOW,KAAA,OAAAC,MAAA,KAA0BD,KAAA,QAAa5B,EAAAM,GAAAN,EAAA,cAAAO,EAAAC,GAAsC,OAAAL,EAAA,gBAA0BK,MAAAS,OAAea,KAAA,OAAAC,MAAsBC,KAAA,cAAAC,OAA0BC,SAAA3B,EAAA4B,QAAoBhC,EAAA,OAAYc,OAAOW,KAAA,MAAAV,IAAAX,EAAA6B,WAAkCR,KAAA,QAAY5B,EAAAe,GAAA,KAAAZ,EAAA,QAAyBc,OAAOW,KAAA,SAAeA,KAAA,UAAc5B,EAAAe,GAAAf,EAAAgB,GAAAT,EAAA8B,SAAArC,EAAAe,GAAA,KAAAZ,EAAA,iBAA8Dc,OAAOW,KAAA,SAAeA,KAAA,UAAczB,EAAA,OAAAA,EAAA,QAAuBE,YAAA,oBAA8BF,EAAA,MAAAH,EAAAe,GAAA,OAAAf,EAAAe,GAAAf,EAAAgB,GAAAT,EAAA+B,eAAA,OAA8D,GAAAtC,EAAAe,GAAA,KAAAZ,EAAA,mBAE/0CoC,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACAtE,EACA0B,GATA,EAVA,SAAA6C,GACAF,EAAA,SAaA,KAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"static/js/22.ffce882aa6d0ff8aa26b.js","sourcesContent":["<template>\n    <div class=\"goodslist\">\n        <div class=\"itembox\" v-if=\"list.length\">\n            <ul>\n                <li v-for=\"(item, index) in label\" :key=\"index\">\n                    <span :class=\"{active: item.checked}\" @click=\"clickFilter(index)\">{{ item.title }}</span>\n                    <div class=\"sort-img\">\n                        <img class=\"top\" :src=\"item.top ? icons.topChecked : icons.top\" v-if=\"index\"/>\n                        <img class=\"bottom\" :src=\"item.bottom ? icons.bottomChecked : icons.bottom\" />\n                    </div>\n                </li>\n            </ul>\n        </div>\n        <yd-infinitescroll :callback=\"loadMore\" :distance=\"2\" :scroll-top=\"false\" ref=\"infinitescrollDemo\" class=\"itemgoodslist\">\n            <yd-list theme=\"4\" slot=\"list\">\n                <yd-list-item v-for='(item, key) in list' :key='key' type=\"link\" :href=\"{path:'goodsdetail',query:{goods_id:item.id}}\">\n                    <img slot='img' :src='item.image_url'>\n                    <span slot='title'>{{item.name}}</span>\n                    <yd-list-other slot='other'>\n                        <div>\n                            <span class='demo-list-price'><em>¥</em>{{item.price}}</span>\n                        </div>\n                    </yd-list-other>\n                </yd-list-item>\n            </yd-list>\n        </yd-infinitescroll>\n        <yd-backtop></yd-backtop>\n    </div>\n</template>\n\n<script>\nexport default {\n    data () {\n        return {\n            page: 1,\n            pageSize: 10, // 每页10条数据\n            label: [\n                {title: '综合', checked: true, top: false, bottom: true, condition: ''},\n                {title: '销量', checked: false, top: false, bottom: false, condition: 'buy_count'},\n                {title: '价格', checked: false, top: false, bottom: false, condition: 'price'}\n            ],\n            icons: {\n                top: './static/image/graytop.png',\n                topChecked: './static/image/redtop.png',\n                bottom: './static/image/graybottom.png',\n                bottomChecked: './static/image/redbottom.png'\n            },\n            checkedFilter: 0, // 选中的第几个搜索条件 区分再次点击\n            filter: this.GLOBAL.getStorage('filter') ? this.GLOBAL.getStorage('filter') : '', // order查询的筛选条件\n            catId: this.$route.query.cat_id || 0, // 分类条件\n            brand: this.$route.query.brand, // 品牌id\n            hot: this.$route.query.hot || 0, // 热门\n            keywords: this.$route.query.keywords || 0, // 搜索条件\n            list: [] // 指定分类的商品数据\n        }\n    },\n    mounted () {\n        if (this.GLOBAL.getStorage('filter')) {\n            // 从本地取出筛选状态\n            let arr = this.GLOBAL.getStorage('filter').split(' ')\n            this.label.forEach((v, k) => {\n                if (v.condition === arr[0]) {\n                    this.checkedFilter = k // 第几个筛选条件选中\n                    v.checked = true\n                    arr[1] === 'asc' ? v.top = true : v.top = false\n                    arr[1] === 'desc' ? v.bottom = true : v.bottom = false\n                } else {\n                    v.checked = false\n                    v.top = false\n                    v.bottom = false\n                }\n            })\n        } else {\n            // 否则选中默认的\n            this.label[0].checked = true\n        }\n        this.goodsList()\n    },\n    methods: {\n        // 筛选条件点击\n        clickFilter (index) {\n            // 如果已经是选中的 再次点击切换倒序升序切换 且不是综合的筛选\n            if (this.checkedFilter === index && index !== 0) {\n                this.label[index].top = !this.label[index].top\n                this.label[index].bottom = !this.label[index].bottom\n            } else {\n                // 否则切换对应的筛选条件\n                this.label.forEach((v, k) => {\n                    if (k === index) {\n                        this.checkedFilter = index\n                        v.checked = true\n                        // 此处默认销量降序 价格升序\n                        // 销量 k = 1 价格 k = 2\n                        if (k === 2) {\n                            v.top = true\n                        } else {\n                            v.bottom = true\n                        }\n                    } else {\n                        v.checked = false\n                        v.top = false\n                        v.bottom = false\n                    }\n                })\n            }\n            // 拼接搜索条件\n            let str = ''\n            if (this.label[index].condition) str = this.label[index].top ? ' asc' : ' desc'\n            this.filter = this.label[index].condition + str\n            this.GLOBAL.setStorage('filter', this.filter)\n            this.page = 1 // 筛选条件重新第一页开始\n            this.goodsList()\n        },\n        // 获取商品数据\n        goodsList () {\n            this.$api.goodsList(this.conditions(), res => {\n                const _list = res.data.list\n                this.list = [..._list]\n                if (_list.length < this.pageSize) {\n                    /* 所有数据加载完毕 */\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\n                }\n                this.page++\n            })\n        },\n        // 加载更多\n        loadMore () {\n            this.$api.goodsList(this.conditions(), res => {\n                const _list = res.data.list\n                this.list = [...this.list, ..._list]\n                if (_list.length < this.pageSize) {\n                    /* 所有数据加载完毕 */\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\n                }\n                /* 单次请求数据完毕 */\n                this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.finishLoad')\n                this.page++\n            })\n        },\n        // 统一返回筛选条件 查询条件 分页\n        conditions () {\n            let where = {}\n            if (this.catId) {\n                where = {cat_id: this.catId}\n            } else if (this.hot) {\n                where = {hot: this.hot}\n            } else if (this.keywords) {\n                where = {search_name: this.keywords}\n            } else if (this.brand) {\n                where = {brand_id: this.brand}\n            }\n            let data = {\n                page: this.page,\n                limit: this.pageSize,\n                where: JSON.stringify(where)\n            }\n            if (this.filter) data['order'] = this.filter\n            return data\n        }\n    },\n    // 路由离开 如果不是进入商品详情页则清除筛选状态\n    beforeRouteLeave (to, from, next) {\n        if (to.path !== '/goodsdetail') {\n            this.GLOBAL.removeStorage('filter')\n        }\n        next()\n    }\n}\n</script>\n\n<style>\n    .goodslist  .itemgoodslist{\n        margin-top: .8rem;\n    }\n    .goodslist .itembox{\n        overflow: hidden;\n        zoom: 1;\n        background: #fff;\n        border-bottom: solid 1px #f5f5f5;\n        position: fixed;\n        top: 1rem;\n        width: 100%;\n        z-index: 99999;\n        padding: .1rem 0;\n    }\n    .goodslist .itembox ul li{\n        width: 33.3%;\n        float: left;\n        height: .6rem;\n        line-height: .6rem;\n        position: relative;\n    }\n    .goodslist .itembox ul li img{\n        /*vertical-align: middle;*/\n    }\n    .goodslist .itembox .sort-img{\n        display: inline-block;\n        position: absolute;\n        top: 50%;\n        transform: translateY(-50%);\n        margin-left: .05rem;\n    }\n    .goodslist .itembox .sort-img img{\n        display: block;\n        width: .2rem;\n    }\n    .goodslist .itembox .sort-img img:nth-child(2n){\n        margin-top: .05rem;\n    }\n    .active {\n        color: #FF3B44;\n    }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/GoodsList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"goodslist\"},[(_vm.list.length)?_c('div',{staticClass:\"itembox\"},[_c('ul',_vm._l((_vm.label),function(item,index){return _c('li',{key:index},[_c('span',{class:{active: item.checked},on:{\"click\":function($event){_vm.clickFilter(index)}}},[_vm._v(_vm._s(item.title))]),_vm._v(\" \"),_c('div',{staticClass:\"sort-img\"},[(index)?_c('img',{staticClass:\"top\",attrs:{\"src\":item.top ? _vm.icons.topChecked : _vm.icons.top}}):_vm._e(),_vm._v(\" \"),_c('img',{staticClass:\"bottom\",attrs:{\"src\":item.bottom ? _vm.icons.bottomChecked : _vm.icons.bottom}})])])}))]):_vm._e(),_vm._v(\" \"),_c('yd-infinitescroll',{ref:\"infinitescrollDemo\",staticClass:\"itemgoodslist\",attrs:{\"callback\":_vm.loadMore,\"distance\":2,\"scroll-top\":false}},[_c('yd-list',{attrs:{\"slot\":\"list\",\"theme\":\"4\"},slot:\"list\"},_vm._l((_vm.list),function(item,key){return _c('yd-list-item',{key:key,attrs:{\"type\":\"link\",\"href\":{path:'goodsdetail',query:{goods_id:item.id}}}},[_c('img',{attrs:{\"slot\":\"img\",\"src\":item.image_url},slot:\"img\"}),_vm._v(\" \"),_c('span',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(_vm._s(item.name))]),_vm._v(\" \"),_c('yd-list-other',{attrs:{\"slot\":\"other\"},slot:\"other\"},[_c('div',[_c('span',{staticClass:\"demo-list-price\"},[_c('em',[_vm._v(\"¥\")]),_vm._v(_vm._s(item.price))])])])],1)}))],1),_vm._v(\" \"),_c('yd-backtop')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-56ff21a3\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/GoodsList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-56ff21a3\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./GoodsList.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./GoodsList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./GoodsList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-56ff21a3\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./GoodsList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/GoodsList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}